services:
  idrac-2-ntfy:
    build: .
    container_name: idrac-2-ntfy
    restart: unless-stopped
    ports:
      - "162:162/udp"
    env_file:
      - .env
    cap_add:
      - NET_BIND_SERVICE
    # healthcheck by verifying the UDP socket is open
    # (passive â€” no active probe since it's UDP)
    healthcheck:
      test: ["CMD-SHELL", "python -c \"import socket; s=socket.socket(socket.AF_INET,socket.SOCK_DGRAM); s.settimeout(1); s.bind(('127.0.0.1',0)); s.close()\""]
      interval: 60s
      timeout: 5s
      retries: 3
